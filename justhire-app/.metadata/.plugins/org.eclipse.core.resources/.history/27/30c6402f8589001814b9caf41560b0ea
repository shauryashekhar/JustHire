package com.wissen.justhire.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;

import com.wissen.justhire.model.Candidate;
import com.wissen.justhire.model.Question;
import com.wissen.justhire.model.Round;

public interface QuestionRepository extends JpaRepository<Question, Integer> {

	List<Question> findByDifficulty(String difficulty);

	List<Question> findByisApproved(int approved);

	@Query("update Question q set isApproved= 1 where questionId=: questId") // write query
	void approveQuestion(@Param("approved") int approved, @Param("questId") int id);

	@Query("from Question q where q.difficulty=: difficulty AND q.round =: round AND experience =: experience "
			+ "AND isApproved= 1 AND questionId NOT IN ( select question from QuestionAsked where candidate := candidate_id)") // write
	List<Question> findNext(@Param("difficulty") String difficulty, @Param("round") Round round,
			@Param("experience") String experience, @Param("approved") Candidate candidate);

}
